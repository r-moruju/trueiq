
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>TrueIQ â€“ Certificate</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body class="bg-gray-100 p-10">
  <div class="max-w-2xl mx-auto bg-white shadow-2xl rounded-lg p-8 border border-gray-300">
    <h1 class="text-3xl font-bold text-center text-indigo-700 mb-6">ðŸŽ“ Download Your Official Certificate</h1>
    <input id="userName" placeholder="Full Name" class="border p-2 rounded w-full max-w-md mx-auto block mb-3" />
    <input id="userEmail" placeholder="Email Address" class="border p-2 rounded w-full max-w-md mx-auto block mb-3" />
    <button onclick="generateCertificate()" class="bg-blue-700 hover:bg-blue-800 text-white px-6 py-2 rounded mx-auto block mt-4">
      ðŸ“„ Generate PDF Certificate
    </button>
  </div>

<script>
function calculateIQ(score, time) {
  const base = (score / 15) * 50 + 75;
  const tpq = time / score;
  let boost = tpq < 8 ? 10 : tpq < 12 ? 5 : 0;
  return Math.round(Math.min(base + boost, 160));
}

async function generateCertificate() {
  const name = document.getElementById("userName").value.trim();
  const email = document.getElementById("userEmail").value.trim();
  const score = parseInt(localStorage.getItem("iqScore") || "0");
  const time = parseInt(localStorage.getItem("totalTimeTaken") || "0");
  const iq = calculateIQ(score, time);
  const date = new Date().toLocaleDateString();

  if (!name || !email) {
    alert("Please fill in name and email.");
    return;
  }

  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  const logo = new Image();
  logo.src = "logo.png";
  logo.onload = function () {
    doc.addImage(logo, "PNG", 80, 10, 50, 20);
    doc.setDrawColor(180);
    doc.rect(10, 10, 190, 270, "S");

    doc.setFontSize(20);
    doc.setFont("times", "bold");
    doc.text("Certificate of Achievement", 105, 50, null, null, "center");

    doc.setFontSize(12);
    doc.setFont("helvetica", "normal");
    doc.text("This certifies that", 105, 65, null, null, "center");

    doc.setFontSize(16);
    doc.setTextColor(33, 60, 130);
    doc.text(name, 105, 80, null, null, "center");

    doc.setTextColor(0, 0, 0);
    doc.setFontSize(12);
    doc.text("has successfully completed the TrueIQ Intelligence Test", 105, 95, null, null, "center");
    doc.text("Scored: " + score + "/15", 105, 110, null, null, "center");
    doc.text("Estimated IQ: " + iq, 105, 120, null, null, "center");
    doc.text("Date: " + date, 105, 130, null, null, "center");

    // Fake sigil
    doc.setFontSize(10);
    doc.setFont("courier", "bold");
    doc.text("TRUEIQ INTELLIGENCE BOARD", 105, 170, null, null, "center");

    // Fake signature
    doc.setFontSize(20);
    doc.setFont("times", "italic");
    doc.text("Dr. R. Moruju", 40, 200);
    doc.setFontSize(10);
    doc.setFont("helvetica", "normal");
    doc.text("Administrator", 40, 207);

    doc.save(name.replace(/\s+/g, "_") + "_TrueIQ_Certificate.pdf");
  };
}
</script>
</body>
</html>
